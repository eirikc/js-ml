<!doctype html>
<!--This is an HTML5 document-->
<html lang="en">

<head>

    <meta charset="utf-8">
    <title>Quick Masterloop</title>
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="favicon.ico">

</head>

<body>

    <div class="toolbar">
        <img src="https://eirikc.github.io/js-ml/favicon.ico" id="icon" alt="Quick Masterloop" width="auto"
            height="auto">
        <!-- Input field for serial numbers -->
        <input type="text" name="Serial number" placeholder="Serial number" id="sn_id" maxlength="12" size="11" autofocus/>

        <!-- Buttons for Masterloop pages and quick plots.
            Will check if ctrl is pressed and will open a new tab if true -->
        <!--input type="submit" id="btnDevice" value="âž¡ Device" onclick="if(event.ctrlKey) setURLCTRL(); else setURL()"-->
        <button type="submit" id="btnObservations" class="small-buttons" value="Observations" title="Observations"
            onclick="if(event.ctrlKey) ObservationsCTRL(); else if(event.metaKey) ObservationsCTRL(); else Observations()"><img
                src="https://eirikc.github.io/js-ml/Observations.svg" style="float: center; width: 30px;"></button>
        <button type="submit" id="btnSettings" class="small-buttons" value="Settings" title="Settings"
            onclick="if(event.ctrlKey) SettingsCTRL(); else if(event.metaKey) SettingsCTRL(); else Settings()"><img
                src="https://eirikc.github.io/js-ml/Settings.svg" style="float: center; width: 30px;"></button>
        <button type="submit" id="btnCommands" class="small-buttons" value="Commands" title="Control - Quick commands"
            onclick="if(event.ctrlKey) CommandsCTRL(); else if(event.metaKey) CommandsCTRL(); else Commands()"><img
                src="https://eirikc.github.io/js-ml/Control.svg" style="float: center; width: 30px;"></button>
        <button type="submit" id="btnHistory" class="small-buttons" value="History" title="Command history"
            onclick="if(event.ctrlKey) HistoryCTRL(); else if(event.metaKey) HistoryCTRL(); else History()"><img
                src="https://eirikc.github.io/js-ml/Commands.svg" style="float: center; width: 30px;"></button>
        <button type="submit" id="btnCharging" value="Charging" title="Charging plots"
            onclick="if(event.ctrlKey) chargerPlotsCTRL(); else if(event.metaKey) chargerPlotsCTRL(); else chargerPlots()"><img
                src="https://eirikc.github.io/js-ml/favicon.ico" style="float: center; width: 20px;">Charging</button>
        <button type="submit" id="btnNetwork" value="Network" title="Network connectivity plots"
            onclick="if(event.ctrlKey) networkPlotsCTRL(); else if(event.metaKey) networkPlotsCTRL(); else networkPlots()"><img
                src="https://eirikc.github.io/js-ml/favicon.ico" style="float: center; width: 20px;">Network</button>
        <button type="submit" id="btnEqualizer" value="Equalizer" title="Equalizer plots"
            onclick="if(event.ctrlKey) equalizerPlotsCTRL(); else if(event.metaKey) equalizerPlotsCTRL(); else equalizerPlots()"><img
                src="https://eirikc.github.io/js-ml/favicon.ico" style="float: center; width: 20px;">Equalizer</button>
        <button type="submit" id="btnDerate" value="Derate" title="Derating charger plots"
            onclick="if(event.ctrlKey) deratePlotsCTRL(); else if(event.metaKey) deratePlotsCTRL(); else deratePlots()"><img
                src="https://eirikc.github.io/js-ml/favicon.ico" style="float: center; width: 20px;">Derating</button>
        <button type="submit" id="btnList" value="List" title="Charger mode list"
            onclick="if(event.ctrlKey) listPlotsCTRL(); else if(event.metaKey) listPlotsCTRL(); else listPlots()"><img
                src="https://eirikc.github.io/js-ml/favicon.ico" style="float: center; width: 20px;">Mode List</button>
    </div>


    <iframe id="ml_embed" title="Masterloop page" src="https://portal.masterloop.net/#/devices/filter/recent"
        frameborder="0" style="overflow:hidden;height:100%;width:100%" height="100%" width="100%">
    </iframe>

    <script>
        // focus text cursor on serial number input on load.
        window.onload = function() {
        var input = document.getElementById("sn_id").focus();
        }

        // Spellchecker to ignore everything that isn't characters or numbers
        // and replace lowercase letters with upper case letters.
        document.getElementById('sn_id').addEventListener('input', function () {
            var position = this.selectionStart;
            this.value = this.value.replace(/[^a-zA-Z0-9]+/g, '');
            this.value = this.value.toUpperCase();
            this.selectionEnd = position;
        });

        //Function for Enter-key go to device page
        var serial = document.getElementById("sn_id");
        serial.addEventListener("keydown", function (event) {
            if (event.keyCode === 13) {
                setURL(event);
            }
        });

        // Functions for buttons to redirect masterloop embed
        //Ignores for the most part bad serial numbers.
        function setURL() {
            var sn_value = document.getElementById("sn_id").value;
            var ml_url = "https://portal.masterloop.net/#/devices/general/" + sn_value;
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                document.getElementById("ml_embed").src = ml_url;
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }

        function Observations() {
            var sn_value = document.getElementById("sn_id").value;
            var Observations_url = "https://portal.masterloop.net/#/devices/observations/" + sn_value;
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                document.getElementById("ml_embed").src = Observations_url;
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }

        function Settings() {
            var sn_value = document.getElementById("sn_id").value;
            var Settings_url = "https://portal.masterloop.net/#/devices/settings/" + sn_value;
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                document.getElementById("ml_embed").src = Settings_url;
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }

        function Commands() {
            var sn_value = document.getElementById("sn_id").value;
            var Commands_url = "https://portal.masterloop.net/#/devices/quickCommands/" + sn_value;
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                document.getElementById("ml_embed").src = Commands_url;
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }

        function History() {
            var sn_value = document.getElementById("sn_id").value;
            var History_url = "https://portal.masterloop.net/#/devices/" + sn_value + "/commandsHistory";
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                document.getElementById("ml_embed").src = History_url;
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }

        function chargerPlots() {
            var sn_value = document.getElementById("sn_id").value;
            var charger_url = "https://portal.masterloop.net/#/devices/observations/" + sn_value + "/plots?filter=[21,38,46,96,104,109,110,114,120,182,183,184,185,194,195,196,197,198,199]";
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                document.getElementById("ml_embed").src = charger_url;
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }

        function networkPlots() {
            var sn_value = document.getElementById("sn_id").value;
            var network_url = "https://portal.masterloop.net/#/devices/observations/" + sn_value + "/plots?filter=[11,46,130,131,132,136,150,141]";
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                document.getElementById("ml_embed").src = network_url;
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }

        function equalizerPlots() {
            var sn_value = document.getElementById("sn_id").value;
            var equalizer_url = "https://portal.masterloop.net/#/devices/observations/" + sn_value + "/plots?filter=[29,31,32,33,34,35,36,37,38,39,50,70,87,88,89,100]";
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                document.getElementById("ml_embed").src = equalizer_url;
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check Equalizer serial number");
                return false;
            }
        }

        function deratePlots() {
            var sn_value = document.getElementById("sn_id").value;
            var derate_url = "https://portal.masterloop.net/#/devices/observations/" + sn_value + "/plots?filter=[115,114,116,150,151,152,153,154,155,160,161,162,163,170]";
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                document.getElementById("ml_embed").src = derate_url;
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }
        function listPlots() {
            var sn_value = document.getElementById("sn_id").value;
            var list_url = "https://portal.masterloop.net/#/devices/observations/" + sn_value + "/table?filter=[38,46,100,109,110,114,120,128]";
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                document.getElementById("ml_embed").src = list_url;
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }


        //CTRL + mouse click functions to open new tabs
        function setURLCTRL() {
            var sn_value = document.getElementById("sn_id").value;
            var ml_url = "https://portal.masterloop.net/#/devices/general/" + sn_value;
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                window.open(ml_url);
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }
        function ObservationsCTRL() {
            var sn_value = document.getElementById("sn_id").value;
            var Observations_url = "https://portal.masterloop.net/#/devices/observations/" + sn_value;
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                window.open(Observations_url);
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }
        function SettingsCTRL() {
            var sn_value = document.getElementById("sn_id").value;
            var Settings_url = "https://portal.masterloop.net/#/devices/settings/" + sn_value;
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                window.open(Settings_url);
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }
        function CommandsCTRL() {
            var sn_value = document.getElementById("sn_id").value;
            var Commands_url = "https://portal.masterloop.net/#/devices/quickCommands/" + sn_value;
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                window.open(Commands_url);
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }
        function HistoryCTRL() {
            var sn_value = document.getElementById("sn_id").value;
            var History_url = "https://portal.masterloop.net/#/devices/" + sn_value + "/commandsHistory";
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                window.open(History_url);
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }
        function chargerPlotsCTRL() {
            var sn_value = document.getElementById("sn_id").value;
            var charger_url = "https://portal.masterloop.net/#/devices/observations/" + sn_value + "/plots?filter=[21,38,46,96,104,109,110,114,120,182,183,184,185,194,195,196,197,198,199]";
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                window.open(charger_url);
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }
        function networkPlotsCTRL() {
            var sn_value = document.getElementById("sn_id").value;
            var network_url = "https://portal.masterloop.net/#/devices/observations/" + sn_value + "/plots?filter=[11,46,130,131,132,136,150,141]";
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                window.open(network_url);
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }
        function equalizerPlotsCTRL() {
            var sn_value = document.getElementById("sn_id").value;
            var equalizer_url = "https://portal.masterloop.net/#/devices/observations/" + sn_value + "/plots?filter=[20,31,32,33,34,35,36,50,70,87,89]";
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                window.open(equalizer_url);
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check Equalizer serial number");
                return false;
            }
        }
        function deratePlotsCTRL() {
            var sn_value = document.getElementById("sn_id").value;
            var derate_url = "https://portal.masterloop.net/#/devices/observations/" + sn_value + "/plots?filter=[115,114,116,150,151,152,153,154,155,160,161,162,163,170]";
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                window.open(derate_url);
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }
        function listPlotsCTRL() {
            var sn_value = document.getElementById("sn_id").value;
            var list_url = "https://portal.masterloop.net/#/devices/observations/" + sn_value + "/table?filter=[38,46,100,109,110,114,120,128]";
            var sn_length = document.getElementById("sn_id").value.length;
            if 
                (sn_length === 8 && 
                (sn_value.startsWith("EC") === true
                || sn_value.startsWith("EH") === true
                || sn_value.startsWith("UK") === true
                || sn_value.startsWith("QC") === true
                || sn_value.startsWith("QP") === true
                || sn_value.startsWith("EQ") === true
                || sn_value.startsWith("QH") === true)) {
                window.open(list_url);
            }
            else if
            (sn_value === "") {
                return false
            }
            else {
                alert("Check serial number");
                return false;
            }
        }

    </script>

</body>

<style>
    #icon {
        max-width: 39px;
        min-width: 39px;
        max-height: 39px;
        min-height: 39px;
        padding-left: 11px;
        padding-right: 11px;
        padding-top: 10px;
        padding-bottom: 15px;
    }

    iframe {
        position: fixed;
        left: 0px;
        background: #007DBD;
    }

    body {
        background-color: #007DBD;
        margin-top: 0px;
    }

    .toolbar button {
        background: #007DBD;
        border: 1px solid #007DBD;
        color: #fff;
        cursor: pointer;
        -webkit-transition: all 0.2s;
        -moz-transition: all 0.2s;
        transition: all 0.2s;
        flex-basis: 120px;
        min-width: 110px;
        max-width: 140px !important;
        margin-bottom: 7px;
        margin-top: 2.5px;
    }

    .toolbar button img {
        vertical-align: middle;
        padding-right: 5px;
    }

    button.small-buttons {
        flex-basis: 0px !important;
        min-width: 65px;
        padding: auto;
        padding-right: 0px;
        padding-top: 0px;
        padding-bottom: 0px;
        padding-left: 4px;
    }

    #btnCommands {
        padding-left: 7px !important;
    }

    .toolbar button:hover {
        background: #0070a8;
        border-radius: 3px;
    }

    .toolbar {
        display: -webkit-box;
        display: flex;
        z-index: 10;
        position: fixed;
        left: 0px;
        width: 100%;
        height: 60px;
        background: #007DBD;
        overflow: auto;
        overflow: overlay;
        margin-top: 4px;
        overflow-y: hidden;
    }

    .toolbar>* {
        border: 0;
        font-size: 1rem;
        border-radius: 0;
        outline: 0;
        -webkit-appearance: none;
    }

    input[type="text"] {
        flex-basis: 158px;
        padding: 2px 0 0 19px;
        margin-bottom: 7.5px;
        margin-left: 0px;
        margin-right: 7px;
        margin-top: 3px;
        border-radius: 2px;
    }

    ::-webkit-scrollbar {
        width: 20px;
    }

    ::-webkit-scrollbar-track {
        background-color: transparent;
    }

    ::-webkit-scrollbar-thumb {
        background-color: #d6dee100;
        border-radius: 20px;
        border: 6px solid transparent;
        background-clip: content-box;
    }

    ::-webkit-scrollbar-thumb:hover {
        background-color: #a8bbbf;
    }

    ::placeholder {
        color: rgb(161, 161, 161)
    }
    html {
    overflow-y: overlay;
}
</style>

</html>
